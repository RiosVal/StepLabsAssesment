{{ 'science-stats.css' | asset_url | stylesheet_tag }}

<section id="section-{{ section.id }}" class="science-stats">
  <div class="science-stats__inner">
    <div class="science-stats__media">
      {% if section.settings.image != blank %}
        <img
          src="{{ section.settings.image | image_url: width: 800 }}"
          alt="{{ section.settings.image_alt | escape }}"
          loading="lazy"
          width="1600"
          height="600"
        />
      {% endif %}
    </div>

    <div class="science-stats__content">
      {% if section.settings.title != blank %}
        <h2 class="science-stats__title">{{ section.settings.title }}</h2>
      {% endif %}

      <!-- GRID AGRUPADO POR SUBTÍTULOS -->
      {% for block in section.blocks %}
        {% if block.type == 'stat_group' %}
          <div class="science-stats__group">
            {% if block.settings.group_title != blank %}
              <p class="science-stats__group-title">{{ block.settings.group_title }}</p>
            {% endif %}

            <div class="science-stats__grid">
              <!-- Stat 1 -->
              <div class="science-stat-card">
                {% if block.settings.stat1_source != blank %}
                  <div class="science-stat-card__source">{{ block.settings.stat1_source }}</div>
                {% endif %}
                {% if block.settings.stat1_heading != blank %}
                  <div class="science-stat-card__heading">{{ block.settings.stat1_heading }}</div>
                {% endif %}
                <div class="science-stat-card__value">{{ block.settings.stat1_value }}</div>
                <div class="science-stat-card__label">{{ block.settings.stat1_label }}</div>
              </div>

              <!-- Stat 2 -->
              <div class="science-stat-card">
                {% if block.settings.stat2_source != blank %}
                  <div class="science-stat-card__source">{{ block.settings.stat2_source }}</div>
                {% endif %}
                {% if block.settings.stat2_heading != blank %}
                  <div class="science-stat-card__heading">{{ block.settings.stat2_heading }}</div>
                {% endif %}
                <div class="science-stat-card__value">{{ block.settings.stat2_value }}</div>
                <div class="science-stat-card__label">{{ block.settings.stat2_label }}</div>
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}

      <!-- CTA Y REFERENCIAS DEBAJO -->
      {% for block in section.blocks %}
        {% if block.type == 'cta_button' %}
          <div class="science-stats__cta">
            <a href="{{ block.settings.button_link }}" class="science-stats__see {{ block.settings.button_style }}">
              {{ block.settings.button_label }} →
            </a>
          </div>
        {% elsif block.type == 'references' %}
          <div class="science-stats__references">
            {{ block.settings.references_text | newline_to_br }}
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>


{% schema %}
{
  "name": "Science / Stats",
  "settings": [
    { "type":"text","id":"title","label":"Título","default":"Backed by Science. Proven by Results." },
    { "type":"image_picker","id":"image","label":"Imagen a la izquierda" },
    { "type":"text","id":"image_alt","label":"Alt de la imagen" }
  ],
  "blocks": [
    {
      "type":"stat_group",
      "name":"Grupo de estadísticas",
      "settings":[
        { "type":"text","id":"group_title","label":"Título del grupo" },

        { "type":"text","id":"stat1_heading","label":"Stat 1 - Texto superior" },
        { "type":"text","id":"stat1_value","label":"Stat 1 - Valor" },
        { "type":"text","id":"stat1_label","label":"Stat 1 - Etiqueta" },
        { "type":"text","id":"stat1_source","label":"Stat 1 - Fuente (opcional)" },

        { "type":"text","id":"stat2_heading","label":"Stat 2 - Texto superior" },
        { "type":"text","id":"stat2_value","label":"Stat 2 - Valor" },
        { "type":"text","id":"stat2_label","label":"Stat 2 - Etiqueta" },
        { "type":"text","id":"stat2_source","label":"Stat 2 - Fuente (opcional)" }
      ]
    },
    {
      "type":"cta_button",
      "name":"Botón CTA",
      "settings":[
        { "type":"text","id":"button_label","label":"Texto del botón","default":"See The Science" },
        { "type":"url","id":"button_link","label":"Enlace del botón" },
        { "type":"select","id":"button_style","label":"Estilo","options":[
            {"value":"primary","label":"Primario"},
            {"value":"outline","label":"Contorno"}
          ],
          "default":"primary"
        }
      ]
    },
    {
      "type":"references",
      "name":"Referencias",
      "settings":[
        { "type":"textarea","id":"references_text","label":"Texto de las referencias" }
      ]
    }
  ],
  "presets": [ { "name":"Science / Stats", "category":"Custom" } ]
}
{% endschema %}
